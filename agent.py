# my_team/agent.py
from google.adk.agents import LlmAgent

MODEL = "gemini-2.5-flash"

# =========================
# Player Agents
# =========================

goalkeeper = LlmAgent(
    name="Courtois_GK",
    model=MODEL,
    description=(
        "عامل دروازه‌بان تیم فوتبال که وظیفه اصلی او "
        "جلوگیری از گل خوردن و واکنش سریع در شرایط بحرانی است."
    ),
    instruction="""
نقش تو یک دروازه‌بان سطح بالا است.
ورودی شامل توضیح فارسی از وضعیت توپ و بازیکنان در زمین است.

هر زمان که توپ یا مهاجم حریف در نزدیکی دروازه خودی باشد
(مانند فاصله کم توپ، شوت مستقیم، یا موقعیت تک‌به‌تک)،
باید یک تصمیم دفاعی واضح بگیری؛
مانند خروج به‌موقع، شیرجه، بستن زاویه یا دفع توپ.

خروجی باید دقیقاً با این عبارت شروع شود:
Reaction by the goalkeeper:
و سپس فقط یک جمله کوتاه از واکنش تو نوشته شود.
""".strip(),
)

defender = LlmAgent(
    name="RubenDias_DEF",
    model=MODEL,
    description=(
        "عامل مدافع تیم که مسئول محافظت از فضای دفاعی، "
        "مهار مهاجمان حریف و پشتیبانی از دروازه‌بان است."
    ),
    instruction="""
تو در نقش مدافع بازی می‌کنی.
اگر شرایط نشان‌دهنده فاز دفاعی باشد
(حضور توپ در زمین خودی، فشار حریف، نفوذ یا ارسال خطرناک)،
باید واکنش دفاعی نشان بدهی:
یارگیری، قطع مسیر حرکت یا پاس، بستن شوت یا پوشش فضا.

خروجی را دقیقاً با این قالب آغاز کن:
Reaction by the defender:
و بعد یک جمله کوتاه عملیاتی بنویس.
""".strip(),
)

midfielder = LlmAgent(
    name="Modric_MID",
    model=MODEL,
    description=(
        "عامل هافبک میانی که کنترل جریان بازی، "
        "اتصال خطوط و مدیریت مالکیت توپ را بر عهده دارد."
    ),
    instruction="""
تو یک هافبک مرکزی و بازی‌ساز هستی.
اگر صحنه مربوط به میانه زمین یا شروع حمله باشد
(گردش توپ، نبود فشار شدید، امکان پاس‌کاری)،
باید واکنش‌هایی مثل حفظ توپ، پاس رو به جلو،
تغییر جهت بازی یا درخواست توپ نشان بدهی.

خروجی را دقیقاً با این قالب شروع کن:
Reaction by the midfielder:
و سپس یک جمله کوتاه تصمیم‌محور ارائه بده.
""".strip(),
)

attacker = LlmAgent(
    name="Mbappe_ST",
    model=MODEL,
    description=(
        "عامل مهاجم تیم که هدف اصلی او ایجاد موقعیت گل، "
        "حرکت پشت خط دفاع و تمام‌کنندگی است."
    ),
    instruction="""
تو مهاجم نوک تیم هستی.
اگر شرایط هجومی باشد
(نزدیکی توپ به محوطه جریمه حریف، ضدحمله، فرصت شوت یا پاس آخر)،
باید واکنش هجومی داشته باشی:
فرار در عمق، درخواست پاس، شوت یا پرس از جلو.

خروجی را دقیقاً با این قالب بنویس:
Reaction by the attacker:
و بعد یک جمله کوتاه از تصمیم خود اضافه کن.
""".strip(),
)

# =========================
# Root Agent
# =========================

root_agent = LlmAgent(
    name="TeamCoordinatorAgent",
    model=MODEL,
    description=(
        "عامل اصلی سیستم چندعاملی که صحنه فوتبال را تحلیل کرده "
        "و تشخیص می‌دهد کدام بازیکن باید واکنش اصلی را نشان دهد."
    ),
    instruction="""
تو نقش عامل ریشه (Root Agent) و هماهنگ‌کننده تیم را داری.
متن فارسی صحنه بازی را تحلیل کن و فقط مناسب‌ترین نقش
را برای واکنش انتخاب کن.

قوانین تصمیم‌گیری:
- اگر خطر فوری نزدیک دروازه خودی باشد:
  -> دروازه‌بان
- اگر توپ در یک‌سوم دفاعی و فشار حریف وجود دارد:
  -> مدافع
- اگر بازی در میانه زمین یا فاز انتقال است:
  -> هافبک
- اگر توپ نزدیک دروازه حریف یا موقعیت گل وجود دارد:
  -> مهاجم

پاسخ نهایی باید فقط خروجی همان عامل انتخاب‌شده باشد
و با عبارت Reaction by ... شروع شود.
""".strip(),
    sub_agents=[goalkeeper, defender, midfielder, attacker],
)
